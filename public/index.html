<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FeedbackOm</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
:root{
    /* --- NEW COLOR PALETTE --- */
    --bg: #f0f9ff; /* Very Light Sky Blue */
    --card: #ffffff;
    --muted: #4b5563; /* Darker, more readable muted text */
    --accent: #9333ea; /* DEEP PURPLE PRIMARY COLOR */
    --radius:12px;
    --shadow: 0 6px 24px rgba(16,24,40,0.08);
    --glass: rgba(255,255,255,0.6);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
    margin:0;
    font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    /* Gradient adapted to new BG color */
    background:linear-gradient(180deg,var(--bg),#e0f2fe);
    color:#0f172a;
    -webkit-font-smoothing:antialiased;
}

.container{max-width:1100px;margin:28px auto;padding:0 20px}
.site-header{background:transparent;padding:18px 0}
.header-row{display:flex;align-items:center;justify-content:space-between}
.brand{font-weight:700;font-size:20px}

.centered-card{max-width:640px;margin:60px auto;padding:28px;border-radius:var(--radius);background:var(--card);box-shadow:var(--shadow);text-align:center}
.card{padding:20px;background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);} 
.small-card{padding:12px}
.hidden{display:none !important;}

.dashboard-grid{display:grid;grid-template-columns:260px 1fr;gap:20px}
.sidebar{display:flex;flex-direction:column;gap:8px}
.sidebar div{font-weight:600}
.main-area{padding:16px}

.tabs{display:flex;gap:8px;margin-bottom:12px}
.tab{background:transparent;border:1px solid transparent;padding:8px 12px;border-radius:10px;cursor:pointer;transition:all 0.2s}
.tab.active{background:linear-gradient(90deg,#fff,#f8fafc);border-color:rgba(15,23,42,0.06);box-shadow:var(--shadow)}
.tab-panel{display:none}
.tab-panel.active{display:block}

form label{display:block;margin-bottom:12px;color:var(--muted)}

input,select,textarea{width:100%;padding:10px;border-radius:10px;border:1px solid #e6e9ef;background:transparent}
textarea{resize:vertical}

/* Ensure the hidden class works correctly for the forms */
.hidden {
    display: none !important; /* CRITICAL: Must be here */
}

#form-toggle button {
    font-weight: 600; /* Use 600, not bold, to match Inter font weight */
    margin-right: 10px;
    transition: all 0.2s;
    border: 1px solid #e6e9ef; /* Give it a light border */
}

/* This rule makes the inactive button look 'unselected' */
#form-toggle button:not(.primary) {
    background-color: var(--card); /* Match card background */
    color: var(--muted); 
}

.actions{margin-top:12px; display: flex; justify-content: flex-end; gap: 10px;}
.question-actions{display:flex;gap:8px;margin-bottom:12px}
.question-row{display:flex;gap:8px;align-items:center;margin-bottom:8px}
.q-prompt{flex:1}
.q-type{font-size:13px;color:var(--muted);padding:6px 8px;background:#f3f4f6;border-radius:8px}

.btn{padding:8px 12px;border:none;border-radius:10px;background:#f3e8ff; /* Light purple for secondary btn */ color:var(--accent);cursor:pointer; transition:all 0.2s}
.btn.primary{background:var(--accent);color:white;box-shadow:0 8px 20px rgba(147,51,234,0.25)} /* Shadow updated for purple */
.btn.small{padding:6px 8px;font-size:13px}
.btn:focus{outline:2px solid rgba(147,51,234,0.18)}

.mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Roboto Mono', 'Courier New', monospace;background:#0f172a;color:#fff;padding:8px;border-radius:8px}

#qrcode{margin-top:12px; padding: 20px; text-align: center;}

.survey-row{display:flex;justify-content:space-between;align-items:center;padding:12px;border-bottom:1px dashed #eef2f6}
.survey-title{font-weight:600}
.survey-meta{color:var(--muted);font-size:13px}

.response-row{padding:10px;border-radius:10px;background:#fafafa;margin-bottom:8px;border:1px solid #f1f5f9;font-family:monospace;font-size:13px}

.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(2,6,23,0.5);z-index:1000}
.modal.hidden { display: none !important; }
.modal-card{width:min(680px,92%);background:var(--card);padding:20px;border-radius:14px;box-shadow:0 12px 36px rgba(2,6,23,0.3)}
.modal-title{font-weight:700;margin-bottom:8px}
.modal-body{color:var(--muted);margin-bottom:12px}
.modal-actions{text-align:right}

/* Utility/Dashboard Classes */
.points-card { border-left: 4px solid var(--accent); }
.created-card { border-left: 4px solid #10b981; } /* Green for creation success */
.affiliation-card { border-left: 4px solid #f97316; } /* Orange for visibility */
.grid-3-cols { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
.p-4 { padding: 16px; }
.mb-20 { margin-bottom: 20px; }
.text-xl { font-size: 20px; }
.text-2xl { font-size: 24px; }
.text-3xl { font-size: 30px; }
.font-bold { font-weight: 700; }
.font-semibold { font-weight: 600; }
.text-center { text-align: center; }
.text-muted { color: var(--muted); }
.flex { display: flex; }
.gap-4 { gap: 16px; }
.flex-wrap { flex-wrap: wrap; }
.flex-1 { flex: 1; }
.h-full { height: 100%; }

@media (max-width:900px){
    .dashboard-grid{grid-template-columns:1fr;}
    .sidebar{flex-direction:row;justify-content:space-between}
    .grid-3-cols { grid-template-columns: 1fr; }
}
    </style>
  </head>
  <body>
    <header class="site-header">
      <div class="container header-row">
        <div class="brand">FeedbackOm</div>
        <nav class="nav"></nav>
      </div>
    </header>

    <!-- Dev helper: visible on localhost or when ?dev=1 is present -->
    <div id="dev-panel" class="card hidden" style="position:fixed;right:18px;top:72px;z-index:1200;max-width:420px;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><strong>Dev Config Helper</strong><button id="dev-close" class="btn small">Close</button></div>
      <label>App ID<input id="dev-appid" placeholder="app id (optional)" /></label>
      <label>Initial Auth Token<input id="dev-token" placeholder="custom token (optional)" /></label>
      <label>Firebase Config (JSON)
        <textarea id="dev-config" rows="8" placeholder='Paste firebase config JSON here' style="width:100%;border-radius:8px;padding:8px;border:1px solid #e6e9ef;background:transparent"></textarea>
      </label>
      <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:8px">
        <button id="dev-apply" class="btn primary">Apply & Reload</button>
      </div>
    </div>

    <main class="container" id="app">
      <!--<div id="loading" class="centered-card">Loadingâ€¦</div>-->

      <!-- Profile creation form -->
      <div id="profile-setup" class="card">
        <h2 id="setup-title">Create Your Profile</h2>

        <div id="form-toggle" style="margin-bottom: 20px;">
          <button id="toggle-signup" class="btn primary small" type="button">New User</button>
          <button id="toggle-signin" class="btn small" type="button">Returning Member</button>
        </div>

        <form id="signup-form">
          <label>First Name<input name="firstName" required /></label>
          <label>Email<input name="email" type="email" required /></label>
          <label>Password<input name="password" type="password" required minlength="6" /></label>
          <label>Age Group
            <select name="ageGroup" required>
              <option value="">Select age group</option>
              <option>Under 18</option>
              <option>18-24</option>
              <option>25+</option>
            </select>
          </label>
          <label>Institution Type
            <select name="institutionType" required>
              <option value="">Select</option>
              <option>School/University</option>
              <option>Company/Firm</option>
              <option>Non-Profit</option>
            </select>
          </label>
          <div class="actions">
            <button type="submit" class="btn primary" id="signup-btn">Create Profile</button>
          </div>
        </form>

        <form id="signin-form" class="hidden">
          <label>Email<input name="email" type="email" required /></label>
          <label>Password<input name="password" type="password" required /></label>
          <div class="actions">
            <button type="submit" class="btn primary" id="signin-btn">Sign In</button>
          </div>
        </form>
      </div>

      <!-- Main dashboard -->
      <div id="dashboard" class="hidden">
        <div class="dashboard-grid">
          <aside class="sidebar card">
            <div id="user-name">Name</div>
            <div id="user-points">Points: 0</div>
            <div id="surveys-count">Surveys Created: 0</div>
          </aside>
<section class="main-area card">
            <div class="tabs">
              <button data-tab="dashboard" class="tab active">Dashboard</button>
              <button data-tab="create" class="tab">Create QR Survey</button>
              <button data-tab="my" class="tab">My Surveys & Responses</button>
            </div>

            <div id="tab-dashboard" class="tab-panel active">
              <h3>Welcome</h3>
              <p id="welcome-msg"></p>
              
              <div class="grid-3-cols" style="margin-top: 25px;">
                  <div class="card p-4 created-card">
                      <div class="text-xl font-bold mb-20">Create a New Survey</div>
                      <p class="text-muted">Generate a unique QR code survey link for instant feedback.</p>
                      <button data-tab="create" class="btn primary mt-4">Start Creating</button>
                  </div>
                  
                  <div class="card p-4 points-card">
                      <div class="text-xl font-bold mb-20">View My Surveys</div>
                      <p class="text-muted">Check responses and share links for your active campaigns.</p>
                      <button data-tab="my" class="btn primary mt-4">Manage Surveys</button>
                  </div>

                  <div class="card p-4 affiliation-card">
                      <div class="text-xl font-bold mb-20">Advanced Tools</div>
                      <p class="text-muted">Integrate FeedbackOm directly into your own website or application.</p>
                      <button class="btn mt-4" disabled>Coming Soon</button>
                  </div>
              </div>
            </div>

            <div id="tab-create" class="tab-panel">
              <h3>Create QR Survey</h3>
              
              <div style="margin-bottom: 20px; padding: 15px; border: 1px solid var(--accent); border-radius: var(--radius); background: var(--bg);">
                <strong style="display:block; margin-bottom: 8px;">Need quick presentation feedback?</strong>
                <button type="button" id="load-quick-survey-btn" class="btn primary">
                    Load 4-Question Quick Survey
                </button>
              </div>
              
              <form id="create-survey-form">
                <label>Survey Title<input name="title" required value="New Feedback Survey" /></label>
                
                <h4>Questions:</h4>
                <div id="questions-list"></div>
                
                <div class="question-actions">
                  <button type="button" id="add-text" class="btn">Add Text Feedback</button>
                  <button type="button" id="add-rating" class="btn">Add 1-5 Rating</button>
                </div>
                
                <div class="actions">
                  <button type="submit" id="create-survey-btn" class="btn primary">Create Survey</button>
                </div>
              </form>

              <div id="share-panel" class="hidden">
                <h4>Survey Created! Share Your Link:</h4>
                
                <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 20px;">
                    <div id="share-url" class="mono" style="flex-grow: 1; padding: 10px; border: 1px dashed var(--muted);"></div>
                    <button id="copy-btn" class="btn primary small" type="button">Copy Link</button>
                </div>
                
                <h4 style="margin-top: 20px;">Or Scan the QR Code:</h4>
                <div id="qrcode"></div>
              </div>
            </div>

            <div id="tab-my" class="tab-panel">
              <h3>My Surveys</h3>
              <div id="my-surveys-list"></div>
              <div id="responses-panel" class="hidden card small-card">
                <h4>Responses for <span id="responses-survey-title"></span></h4>
                <div id="responses-list"></div>
              </div>
            </div>
          </section>
        </div>
      </div>

      <!-- Response mode view -->
      <div id="response-mode" class="card hidden">
        <h2 id="response-title">Survey</h2>
        <form id="response-form"></form>
      </div>

      <!-- Thank you screen -->
      <div id="thankyou" class="card hidden">
        <h2>Thank you!</h2>
        <p>Your feedback has been submitted.</p>
      </div>
    </main>

    <!-- Modal (for ALL notifications) -->
    <div id="modal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modal-card">
        <div id="modal-title" class="modal-title"></div>
        <div id="modal-body" class="modal-body"></div>
        <div class="modal-actions"><button id="modal-ok" class="btn primary">OK</button></div>
      </div>
    </div>

   <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script type="module" src="script.js"></script>
  </body>
</html>
